ğŸ“… ì œì£¼ëŒ€í•™êµ ê°•ì˜ ì‹œê°„í‘œ ë°ì´í„°ë¥¼ ë§¤ì¼ ê°±ì‹ í•˜ì—¬ ê¸°ê¸°ì˜ ê¸°ë³¸ ìº˜ë¦°ë” í´ë¼ì´ì–¸íŠ¸(Google, Apple Calendar ë“±)ì—ì„œ êµ¬ë…í•  ìˆ˜ ìˆëŠ” icalendar ì„œë²„ë¥¼ êµ¬ì¶•í•˜ëŠ” ì›¹ ì˜¤í† ë©”ì´ì…˜ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

![ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€](screenshots/main.webp)

|                                                                   [ì»¨ë²„í„° ëª…ì„¸](src/tests/index.test.ts) ì»¤ë²„ë¦¬ì§€                                                                   |                                                                                 AWS S3 ì—…ë¡œë“œ ìƒíƒœ                                                                                  |
| :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
| [![Test Â· Workflow runs](https://github.com/mu-hun/jejunu-icalendar-server/workflows/Test/badge.svg)](https://github.com/mu-hun/jejunu-icalendar-server/actions/workflows/test.yml) | [![cron Â· Workflow runs](https://github.com/mu-hun/jejunu-icalendar-server/workflows/cron/badge.svg)](https://github.com/mu-hun/jejunu-icalendar-server/actions/workflows/cron.yml) |

## ì‘ì—… ë™ê¸°

ì§€ë‚œ í•™ê¸°<sup>(2024ë…„ 1í•™ê¸°)</sup>, ê°•ì˜ ì¼ì •ì˜ ì¦ì€ ë³€ë™(ê³µíœ´ì¼ ëŒ€ì²´ ìˆ˜ì—…, êµìˆ˜ë‹˜ì˜ ê°œì¸ ì‚¬ì •ìœ¼ë¡œ ì¸í•œ íœ´ê°• ë“±)ì„ ì œì£¼ëŒ€í•™êµ í¬í„¸ ì›¹ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ í™•ì¸í•˜ëŠ” ê³¼ì •ì—ì„œ ì•„ë˜ì™€ ê°™ì€ ë¶ˆí¸ì„ ë°˜ë³µì ìœ¼ë¡œ ê²ªì—ˆìŠµë‹ˆë‹¤:

1. í¬í„¸ ë¡œê·¸ì¸ ì§€ì—°: ë¡œê·¸ì¸ ê³¼ì •ì—ì„œ í•„ìˆ˜ê°€ ì•„ë‹Œ ë¶€ê°€ì ì¸ ë‚´ë¶€ ë¡œì§ìœ¼ë¡œ ì¸í•´ ì•½ 3ì´ˆê°€ëŸ‰ ë¶ˆí•„ìš”í•œ ì§€ì—°ì´ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ì— ì„ì‹œ í•´ê²°ì±…ìœ¼ë¡œ [SSO ìš”ì²­ë§Œ ë°”ë¡œ ìˆ˜í–‰í•˜ëŠ” ì‚¬ìš©ì ìŠ¤í¬ë¦½íŠ¸](https://github.com/mu-hun/jejunu-sw/blob/e190950/portal.user.js#L21)ë¥¼ ì§ì ‘ ì‘ì„±í•´ì„œ ê°œì¸ì ìœ¼ë¡œ ì´ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.
2. iOS í™˜ê²½ì˜ ì œì•½: iOSì—ì„œ [ë¹„ê³µê°œ ë¦´ë ˆì´](https://support.apple.com/ko-kr/102602)ë¥¼ í™œì„±í™”í•  ê²½ìš°, í¬í„¸ ì›¹ ë° ì•± ì„œë¹„ìŠ¤ì˜ ìš”ì²­ ì§€ì—°ì´ ì‚¬ìš©ì´ ë¶ˆê°€ëŠ¥í•  ì •ë„ë¡œ ê¸¸ì–´ì ¸ ë°ìŠ¤í¬íƒ‘ í™˜ê²½ì„ ì£¼ë¡œ ì´ìš©í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.
3. iOS Safari í˜¸í™˜ì„± ë¬¸ì œ: iPhoneì—ì„œ í¬í„¸ ë¡œê·¸ì¸ í˜ì´ì§€ ë¡œë“œê°€ ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìì£¼ ë°œìƒí•´, iOSìš© Firefoxì™€ ê°™ì€ ì„œë“œíŒŒí‹° ë¸Œë¼ìš°ì €ë¥¼ ëŒ€ì‹  ì‚¬ìš©í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.

   <img width="200px" src="screenshots/ios-safari-portal-jejunu-cant-load.webp" alt="ë„¤íŠ¸ì›Œí¬ ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— Safariê°€ í•´ë‹¹ í˜ì´ì§€ë¥¼ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."/>

ì´ì™€ ê°™ì€ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ê°•ì˜ ì‹œê°„í‘œ ë°ì´í„°ë¥¼ ë§¤ì¼ ê°±ì‹ í•˜ì—¬ [icalendar í‘œì¤€](https://icalendar.org/) í˜•ì‹ì˜ `.ics` íŒŒì¼ë¡œ ë³€í™˜í•˜ì—¬, ì´ë¥¼ ì™¸ë¶€ ìº˜ë¦°ë” í´ë¼ì´ì–¸íŠ¸(Google Calendar, Apple Calendar ë“±)ì—ì„œ êµ¬ë…í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ëŠ” HTTP GET ì„œë²„ íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.

![showcases](screenshots/showcases.webp)

ì´ì „ë³´ë‹¤ ì‹œê°„í‘œ ë³€ë™ ì‚¬í•­ì„ ê¸°ê¸°ì—ì„œ ë°”ë¡œ í™•ì¸í•˜ëŠ” í¸ë¦¬í•œ ê²½í—˜ì„ ëˆ„ë¦¬ê³  ìˆëŠ” ì¤‘ì…ë‹ˆë‹¤.

## í…ŒìŠ¤íŠ¸ ì£¼ë„ êµ¬í˜„

íœ´ê°•, ë³´ê°•, ì—°ê°• ë“± ë‹¤ì–‘í•œ ê²½ìš°ë¥¼ í¬í•¨í•œ ì œì£¼ëŒ€í•™êµ í¬í„¸ì˜ [ê°•ì˜ ì‹œê°„í‘œ ë°ì´í„° ìŠ¤í‚¤ë§ˆë¥¼ ë¶„ë¥˜](src/response.ts#L44)í•˜ê³ , ì´ë¥¼ ì‘ì—… ê³¼ì •ì—ì„œ ë³´ë‹¤ ì‰½ê²Œ ì‹ë³„í•  ìˆ˜ ìˆë„ë¡ [ì¬êµ¬ì„±í•œ ê°•ì˜ í˜•ì‹]ì„ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤. ê° ê²½ìš°ì— ì í•©í•œ ì…ë ¥ ë°ì´í„°ë¥¼ ì¤€ë¹„í•˜ê³ , í•´ë‹¹ ë°ì´í„°ì˜ ê¸°ëŒ€ ì¶œë ¥ë„ í•¨ê»˜ ì •ì˜í•˜ì—¬ í…ŒìŠ¤íŠ¸ì— í™œìš©í–ˆìŠµë‹ˆë‹¤.

[ì¬êµ¬ì„±í•œ ê°•ì˜ í˜•ì‹]: src/reconsturct.d.ts#L8_L41

ì¬êµ¬ì„±í•œ ê°•ì˜ í˜•ì‹ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ìš°ì„  ì‘ì„±í•œ í›„, icalendar í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ìœ í‹¸ë¦¬í‹°ë¥¼ êµ¬í˜„í•˜ì˜€ìœ¼ë©° í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ë³€í™˜ ê³¼ì •ì˜ ì •í™•ì„±ì„ ê²€ì¦í–ˆìŠµë‹ˆë‹¤.

1. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¤€ë¹„ ì‘ì—…
   - ê°•ì˜ ì‹œê°„í‘œì˜ ë‹¤ì–‘í•œ ìƒí™©(íœ´ê°•, ë³´ê°• ë“±)ì„ ë°˜ì˜í•œ [ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì„¸íŠ¸](src/tests/testcases.json)ì„ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.
2. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ëª…ì„¸ ì‘ì„±
   - ì¤€ë¹„í•œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì…ë ¥ì„ ê¸°ë°˜ìœ¼ë¡œ [í…ŒìŠ¤íŠ¸ ëª…ì„¸](src/tests/index.test.ts#L17-L77)ë¥¼ ì‘ì„±í•˜ê³ , ìœ í‹¸ë¦¬í‹° êµ¬í˜„ì€ [`src/iCalConverter.ts`](`src/iCalConverter.ts)ì—ì„œ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.
     - [#L3-L21](src/iCalConverter.ts#L40-L59): í¬í„¸ ê°•ì˜ ì‹œê°„í‘œ ë°ì´í„°ì—ì„œ ì¼ë°˜ ê°•ì˜, íœ´ê°•, ë³´ê°•, ì—°ê°•ì„ êµ¬ë¶„í•˜ëŠ” ìœ í‹¸ë¦¬í‹°
     - [#L40-L59](src/iCalConverter.ts#L40-L59): í¬í„¸ ê°•ì˜ ì‹œê°„í‘œ ë°ì´í„°ë¥¼ [ì¬êµ¬ì„±í•œ ê°•ì˜ í˜•ì‹]ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ìœ í‹¸ë¦¬í‹°
     - [#L61-L82](src/iCalConverter.ts#L61-L82): ì—°ê°• ì‹œê°„í‘œë¥¼ í•˜ë‚˜ë¡œ ë³‘í•©í•˜ëŠ” ìœ í‹¸ë¦¬í‹°
     - [#L84-L95](src/iCalConverter.ts#L84-L95): ì¬êµ¬ì„±í•œ ë°ì´í„°ë¥¼ icalendar ì´ë²¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ìœ í‹¸ë¦¬í‹°
3. í†µí•© í…ŒìŠ¤íŠ¸ ì „ìš© ë¤í”„ ë°ì´í„° ë° ê¸°ëŒ€ ì¶œë ¥ íŒŒì¼ ì¤€ë¹„
   - ê°•ì˜ ì‹œê°„í‘œ [ìƒ˜í”Œ ë¤í”„ ë°ì´í„°]ì™€ ê¸°ëŒ€ ì¶œë ¥ [`.ics` íŒŒì¼](src/tests/excepted.ics)ì„ ì¤€ë¹„í•˜ê³ , [í†µí•© í…ŒìŠ¤íŠ¸](src/tests/index.test.ts#L79-L86)ë¥¼ í†µí•´ ì „ì²´ ë³€í™˜ ê³¼ì •ì„ ê²€ì¦í–ˆìŠµë‹ˆë‹¤.

[ìƒ˜í”Œ ë¤í”„ ë°ì´í„°]: src/tests/response.json

## ê´€ë¦¬ ì‹œ ì°¸ê³  ì‚¬í•­

### ì‹œê°„í‘œ ë°ì´í„° ë°›ê¸°

- GET https://portal.jejunu.ac.kr/api/patis/timeTable.jsp
- query params: -`sttLsnYmd`, `endLsnYmd` ê°’ í˜•íƒœëŠ” `YYYYMMDD`

> ì˜ˆ) https://portal.jejunu.ac.kr/api/patis/timeTable.jsp?sttLsnYmd=20240902&endLsnYmd=20241221

### ì‘ë‹µ ì˜ˆì‹œ

ê°•ì˜ ì‹œê°„í‘œ [ìƒ˜í”Œ ë¤í”„ ë°ì´í„°]ë¥¼ ì°¸ê³  ë°”ëë‹ˆë‹¤.

### í¬í„¸ ë‚´ ë³´ê°•, íœ´ê°•, ì˜¨ë¼ì¸ íŒë‹¨ ë¡œì§ ê´€ë ¨ ìŠ¤ë‹ˆí«

```js
const isNine = (str) => str && str.substr(0, 1) == '9';

if (item.cclctYn == 'Y') {
  if (isNine(item.aftrSplctLttmSe)) {
    // ì˜¨ë¼ì¸ ì˜ìƒ
    td += '<span class="label label-red">ì˜¨</span>';
  } else {
    td += '<span class="label label-cancle">íœ´</span>';
  }
} else if (item.splctYn == 'Y') {
  const isUntactNine = isNine(item.untactLsnMthdSe);
  const isAftrNine = isNine(item.aftrSplctLttmSe);

  if (isUntactNine && isAftrNine) {
    // ì˜¨ë¼ì¸ (ë…¹í™”)
    td += '<span class="label label-red">ì˜¨</span>';
  } else if (isUntactNine) {
    // ì˜¨ë¼ì¸ (ì‹¤ì‹œê°„)
    td += '<span class="label label-blue">ì˜¨</span>';
  } else {
    td += '<span class="label label-supplement">ë³´</span>';
  }
}
```
